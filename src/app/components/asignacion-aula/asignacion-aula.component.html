<div class="asignacion-container">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <div class="header">
      <h1 class="welcome">¡Bienvenido/a, <span class="user-name">{{ currentUser }}</span>!</h1>
    </div>

    <div class="content-area">
      <h2 class="page-title">ASIGNACION DE AULA</h2>

      <div class="form-container">
        <!-- Formulario de Asignación -->
        <div class="form-section">
          <div class="section-header">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="section-icon">
              <path d="M10 10C12.7614 10 15 7.76142 15 5C15 2.23858 12.7614 0 10 0C7.23858 0 5 2.23858 5 5C5 7.76142 7.23858 10 10 10Z" fill="currentColor"/>
              <path d="M10 12C5.58172 12 2 15.5817 2 20H18C18 15.5817 14.4183 12 10 12Z" fill="currentColor"/>
            </svg>
            <h3 class="section-title">Nueva Asignación de Aula</h3>
          </div>
          
          <div class="form-fields">
            <div class="form-field">
              <label>Usuario *</label>
              <select [(ngModel)]="selectedUsuarioId" class="form-input" required>
                <option value="0">Seleccione un usuario</option>
                <option *ngFor="let usuario of usuarios" [value]="usuario.id_usuario">
                  {{ usuario.nombre }} ({{ usuario.email }})
                </option>
              </select>
            </div>
            
            <div class="form-field">
              <label>Aula *</label>
              <select [(ngModel)]="selectedAulaId" class="form-input" required>
                <option value="0">Seleccione un aula</option>
                <option *ngFor="let aula of getAulasDisponibles()" [value]="aula.id_aula">
                  {{ aula.nombre }} - {{ aula.ubicacion }} (Capacidad: {{ aula.capacidad }})
                </option>
              </select>
            </div>

            <div class="form-field">
              <label>Fecha de Solicitud</label>
              <input 
                type="date" 
                [(ngModel)]="fechaSolicitud"
                class="form-input">
            </div>
          </div>
        </div>
      </div>

      <!-- Botón Registrar -->
      <div class="action-button-container">
        <button class="btn-registrar" (click)="registrarAsignacion()">
          Registrar Asignación
        </button>
      </div>

      <!-- Lista de Asignaciones -->
      <div class="asignaciones-list" *ngIf="asignaciones.length > 0">
        <h3 class="list-title">Asignaciones Existentes</h3>
        <div class="table-container">
          <table class="asignaciones-table">
            <thead>
              <tr>
                <th>Usuario</th>
                <th>Aula</th>
                <th>Fecha Solicitud</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let asignacion of asignaciones">
                <td>{{ getUsuarioNombre(asignacion.id_usuario) }}</td>
                <td>{{ getAulaNombre(asignacion.id_aula) }}</td>
                <td>{{ formatDate(asignacion.fecha_solicitud) }}</td>
                <td>
                  <span class="status-badge" [class.active]="asignacion.estado" [class.inactive]="!asignacion.estado">
                    {{ asignacion.estado ? 'Activa' : 'Inactiva' }}
                  </span>
                </td>
                <td>
                  <button class="action-btn" (click)="toggleEstadoAsignacion(asignacion)" 
                          [title]="asignacion.estado ? 'Desactivar' : 'Activar'">
                    <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                      <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

